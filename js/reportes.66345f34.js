(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["reportes"],{6020:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"about"},[e("b-container",[e("div",{staticClass:"p-3"},[e("h1",[t._v("Reportes")]),e("b-pagination",{attrs:{"total-rows":t.total,"per-page":t.limit,"first-text":"Primera","prev-text":"Ant.","next-text":"Sig.","last-text":"Última",align:"right"},on:{change:t.changePage},model:{value:t.page,callback:function(a){t.page=a},expression:"page"}}),e("b-table",{attrs:{busy:t.fetching,responsive:"",striped:"",hover:"",items:t.rows,fields:t.fields,"per-page":t.limit,"caption-top":""},on:{"row-dblclicked":t.onClickRow},scopedSlots:t._u([{key:"table-caption",fn:function(){return[t._v("Dar doble clic para editar.")]},proxy:!0},{key:"cell(acciones)",fn:function(a){return[e("b-button",{staticClass:"mr-1",attrs:{size:"sm"},on:{click:function(e){return e.preventDefault(),t.edit(a.index)}}},[e("b-icon-pencil-square")],1),"ADMIN"!==t.auth.user.role.code||t.fetching?t._e():e("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return e.preventDefault(),t.deleteItem(a.index)}}},[e("b-icon-trash")],1)]}}])})],1)])],1)},s=[],o=e("be4a"),n=e("2f62"),c={data:()=>({complaints:[],fields:[],rows:[],pages:1,page:1,total:0,limit:10,fetching:!1}),computed:{...Object(n["c"])(["auth"])},methods:{async getComplaints(t){this.fetching=!0,this.page=t,this.fetching=!0;const{data:a}=await Object(o["d"])({page:t,populate:"city,state,position,user",limit:this.limit});this.complaints=a.data.docs,this.rows=this.complaints.map((t,a)=>{const e=(t.city||{}).name||"",i=(t.state||{}).name||"",s=(t.position||{}).name||"";return{"#":a+1,cargo:s,candidato:t.candidate,partido:t.party,ciudad:e,estado:i,acciones:""}}),this.fields=[{key:"#",sortable:!0},{key:"cargo",sortable:!0},{key:"candidato",sortable:!0},{key:"partido",sortable:!0},{key:"ciudad",sortable:!0},{key:"estado",sortable:!0},{key:"acciones",sortable:!1}],this.pages=a.data.pages,this.total=a.data.total,this.page=a.data.page,this.limit=a.data.limit,this.fetching=!1},async changePage(t){this.getComplaints(t)},onClickRow(t,a){const e=this.getId(a);this.$router.push("/admin/reportes/"+e)},edit(t){const a=this.getId(t);this.$router.push("/admin/reportes/"+a)},getId(t){return this.complaints[t].id},async deleteItem(t){const a=this.getId(t);this.fetching=!0;try{await Object(o["b"])(a),this.getComplaints(this.page)}catch(e){this.$snack.danger({text:e.message})}finally{this.fetching=!1}}},async mounted(){await this.getComplaints(this.page)}},l=c,r=e("2877"),p=Object(r["a"])(l,i,s,!1,null,null,null);a["default"]=p.exports},"8f7f":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.complaint?e("div",{staticClass:"page"},[e("b-container",[e("b-row",{staticClass:"pt-2 pb-2"},[e("b-col",[e("router-link",{attrs:{to:"/admin/reportes"}},[e("b-icon-arrow-left"),t._v(" Ir al listado ")],1)],1)],1),e("b-row",[e("b-col",[e("b-form",{on:{submit:function(a){return a.preventDefault(),t.onSubmit(a)}}},[e("b-row",[e("b-col",[e("b-form-group",{attrs:{label:"Candidato a denunciar:"}},[e("b-form-input",{attrs:{type:"text"},model:{value:t.complaint.candidate,callback:function(a){t.$set(t.complaint,"candidate",a)},expression:"complaint.candidate"}})],1)],1)],1),e("b-row",[e("b-col",[e("b-form-group",{attrs:{label:"Campaña:"}},[e("b-form-input",{attrs:{type:"text"},model:{value:t.complaint.campaign,callback:function(a){t.$set(t.complaint,"campaign",a)},expression:"complaint.campaign"}})],1)],1)],1),e("b-row",[e("b-form-group",{staticClass:"position-fields"},t._l(t.catalogs.positions,(function(a){return e("b-form-radio",{key:a.uuid,attrs:{name:"position",value:a.id},model:{value:t.complaint.position,callback:function(a){t.$set(t.complaint,"position",a)},expression:"complaint.position"}},[t._v(t._s(a.name))])})),1)],1),e("b-row",[e("b-col",{attrs:{md:"6",sm:"12",xs:"12"}},[e("label",[t._v("Estado:")]),e("b-form-select",{on:{change:t.getCities},model:{value:t.complaint.state,callback:function(a){t.$set(t.complaint,"state",a)},expression:"complaint.state"}},t._l(t.catalogs.states,(function(a){return e("b-form-select-option",{key:a.uuid,attrs:{value:a.id}},[t._v(" "+t._s(a.name)+" ")])})),1)],1),e("b-col",{attrs:{md:"6",sm:"12",xs:"12"}},[e("label",[t._v("Ciudad:")]),e("b-form-select",{model:{value:t.complaint.city,callback:function(a){t.$set(t.complaint,"city",a)},expression:"complaint.city"}},t._l(t.cities,(function(a){return e("b-form-select-option",{key:a.uuid,attrs:{value:a.id}},[t._v(" "+t._s(a.name)+" ")])})),1)],1)],1),e("b-row",[e("b-col",{attrs:{md:"6",sm:"12",xs:"12"}},[e("label",[t._v("Partido:")]),e("b-form-input",{staticClass:"mb-2",model:{value:t.complaint.party,callback:function(a){t.$set(t.complaint,"party",a)},expression:"complaint.party"}})],1)],1),e("b-row",[e("b-col",[e("label",[t._v("Fecha del evento:")]),e("b-form-datepicker",{staticClass:"mb-2",model:{value:t.complaint.eventDateTime,callback:function(a){t.$set(t.complaint,"eventDateTime",a)},expression:"complaint.eventDateTime"}})],1)],1),e("b-row",[e("b-col",{attrs:{cols:"12"}},[e("label",[t._v("¿Qué quieres denunciar?")]),e("b-form-textarea",{attrs:{rows:"3","max-rows":"6"},model:{value:t.complaint.description,callback:function(a){t.$set(t.complaint,"description",a)},expression:"complaint.description"}})],1),e("b-col",{attrs:{md:"6",xs:"12"}},[e("div",{staticClass:"p-2"},[e("p",[t._v(" Esta es una plataforma privada, para cualquier comentario o información al respecto contactar a "),e("a",{attrs:{href:"mailto:jacinto.herrera@asacsc.com.mx"}},[t._v("jacinto.herrera@asacsc.com.mx")])]),e("p",[t._v(" Si quieres que tu candidato utilice esta plataforma contáctanos. ")])])]),e("b-col",{staticClass:"complaint-files",attrs:{md:"6",xs:"12"}},[e("b-form-file",{attrs:{multiple:"",placeholder:"Subir archivos"},model:{value:t.complaint.files,callback:function(a){t.$set(t.complaint,"files",a)},expression:"complaint.files"}},[t._v("Subir pruebas")])],1)],1),e("b-row",[e("b-button",{staticClass:"primary-button",attrs:{disabled:this.fetching,type:"submit"}},[t._v("Enviar")])],1)],1)],1)],1)],1)],1):t._e()},s=[],o=e("be4a"),n=e("aca0"),c=e("2f62"),l={data:()=>({complaint:{},cities:[],fetching:!1}),computed:{...Object(c["c"])(["auth","catalogs"])},methods:{...Object(c["b"])({getStates:"catalogs/getStates",getParties:"catalogs/getParties",getPositions:"catalogs/getPositions",createComplaint:"complaints/create"}),async getComplaint(t){const{data:a}=await Object(o["c"])(t);return a.data},async getCities(t){const{data:a}=await Object(n["a"])(t);this.cities=a.data},async updateComplaint(t,a){this.complait=await Object(o["e"])(t,a)},async onSubmit(){this.fetching=!0;try{await this.updateComplaint(this.complaint.id,this.complaint),this.$snack.success({text:"El reporte fue actualizado con éxito."}),this.$router.push("/admin/reportes")}catch(t){this.$snack.danger({text:error.message})}finally{this.fetching=!1}}},async mounted(){this.complaint=await this.getComplaint(this.$route.params.id),await this.getStates(),await this.getCities(this.complaint.state),await this.getParties(),await this.getPositions()}},r=l,p=e("2877"),m=Object(p["a"])(r,i,s,!1,null,null,null);a["default"]=m.exports}}]);
//# sourceMappingURL=reportes.66345f34.js.map